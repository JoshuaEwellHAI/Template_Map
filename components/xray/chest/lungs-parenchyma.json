{
  "$schema": "../../../schema/component-schema.json",
  "component_id": "CMP.xray.chest.lungs-parenchyma",
  "component_type": "finding",
  "name": "Lungs - Parenchyma",
  "description": "Pulmonary parenchymal findings on chest radiograph",
  
  "applies_to": ["XR"],
  "body_region": "chest",
  "section": "FINDINGS",
  "subsection": "Lungs",
  
  "used_by_cpt": ["71045", "71046", "71047", "71048"],
  
  "fields": [
    {
      "field_id": "overall_assessment",
      "label": "Overall Assessment",
      "type": "picklist",
      "required": true,
      "options": [
        {"value": "clear", "label": "Clear", "output_text": "Lungs are clear.", "is_normal": true, "is_default": true},
        {"value": "abnormal", "label": "Abnormal", "output_text": ""},
        {"value": "limited", "label": "Limited evaluation", "output_text": "Lung evaluation is limited."}
      ]
    },
    {
      "field_id": "opacity_present",
      "label": "Opacity Present",
      "type": "boolean",
      "required_if": "overall_assessment == 'abnormal'",
      "show_if": "overall_assessment == 'abnormal'"
    },
    {
      "field_id": "opacity_type",
      "label": "Opacity Type",
      "type": "picklist",
      "required_if": "opacity_present == true",
      "show_if": "opacity_present == true",
      "allow_multiple": true,
      "options": [
        {"value": "consolidation", "label": "Consolidation"},
        {"value": "airspace_opacity", "label": "Airspace opacity"},
        {"value": "ground_glass", "label": "Hazy/ground-glass opacity"},
        {"value": "interstitial", "label": "Interstitial opacity"},
        {"value": "reticular", "label": "Reticular pattern"},
        {"value": "nodular", "label": "Nodular opacity"},
        {"value": "mass", "label": "Mass"}
      ]
    },
    {
      "field_id": "opacity_location",
      "label": "Location",
      "type": "picklist",
      "required_if": "opacity_present == true",
      "show_if": "opacity_present == true",
      "allow_multiple": true,
      "options": [
        {"value": "right_upper", "label": "Right upper lobe/zone"},
        {"value": "right_middle", "label": "Right middle lobe/zone"},
        {"value": "right_lower", "label": "Right lower lobe/zone"},
        {"value": "left_upper", "label": "Left upper lobe/zone"},
        {"value": "lingula", "label": "Lingula"},
        {"value": "left_lower", "label": "Left lower lobe/zone"},
        {"value": "bilateral", "label": "Bilateral"},
        {"value": "perihilar", "label": "Perihilar"},
        {"value": "basilar", "label": "Basilar"},
        {"value": "diffuse", "label": "Diffuse"}
      ]
    },
    {
      "field_id": "opacity_extent",
      "label": "Extent",
      "type": "picklist",
      "required": false,
      "show_if": "opacity_present == true",
      "options": [
        {"value": "focal", "label": "Focal"},
        {"value": "multifocal", "label": "Multifocal"},
        {"value": "patchy", "label": "Patchy"},
        {"value": "confluent", "label": "Confluent"},
        {"value": "diffuse", "label": "Diffuse"}
      ]
    },
    {
      "field_id": "opacity_change",
      "label": "Change from Prior",
      "type": "picklist",
      "required": false,
      "show_if": "opacity_present == true",
      "options": [
        {"value": "new", "label": "New"},
        {"value": "improved", "label": "Improved"},
        {"value": "worsened", "label": "Worsened"},
        {"value": "stable", "label": "Stable"},
        {"value": "resolved", "label": "Resolved"},
        {"value": "no_prior", "label": "No prior for comparison"}
      ]
    },
    {
      "field_id": "atelectasis_present",
      "label": "Atelectasis",
      "type": "boolean",
      "required": false
    },
    {
      "field_id": "atelectasis_type",
      "label": "Atelectasis Type",
      "type": "picklist",
      "show_if": "atelectasis_present == true",
      "options": [
        {"value": "subsegmental", "label": "Subsegmental/platelike"},
        {"value": "segmental", "label": "Segmental"},
        {"value": "lobar", "label": "Lobar"},
        {"value": "complete", "label": "Complete lung collapse"}
      ]
    },
    {
      "field_id": "atelectasis_location",
      "label": "Atelectasis Location",
      "type": "picklist",
      "show_if": "atelectasis_present == true",
      "allow_multiple": true,
      "options": [
        {"value": "right_base", "label": "Right base"},
        {"value": "left_base", "label": "Left base"},
        {"value": "bilateral_bases", "label": "Bilateral bases"},
        {"value": "right_upper", "label": "Right upper lobe"},
        {"value": "right_middle", "label": "Right middle lobe"},
        {"value": "left_upper", "label": "Left upper lobe"}
      ]
    }
  ],
  
  "output_templates": {
    "clear": "Lungs are clear.",
    "atelectasis_only": "{atelectasis_type} atelectasis at the {atelectasis_location}.",
    "opacity": "{opacity_change} {opacity_extent} {opacity_type} in the {opacity_location}.",
    "complex": "{opacity_change} {opacity_extent} {opacity_type} in the {opacity_location}. {atelectasis_statement}"
  },
  
  "clinical_associations": {
    "consolidation": ["Pneumonia", "Aspiration", "Hemorrhage", "Organizing pneumonia"],
    "interstitial": ["Pulmonary edema", "Interstitial lung disease", "Viral pneumonia"],
    "nodular": ["Nodule (see recommendations)", "Metastatic disease", "Granulomatous disease"],
    "mass": ["Primary lung malignancy", "Metastasis", "Benign mass"]
  },
  
  "follow_up_recommendations": {
    "new_consolidation": "Consider pneumonia in appropriate clinical setting.",
    "new_nodule": "Recommend dedicated CT chest for further characterization.",
    "new_mass": "CT chest recommended for further evaluation."
  },
  
  "metadata": {
    "version": "1.0.0",
    "created": "2026-01-28"
  }
}
